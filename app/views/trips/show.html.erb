<%= render "shared/header" %>
<main>
  <div class="container">
    <div class="contents">

      <div class="trip-all">
        <div class="trip-left">
          <div class="trip-title-group">
            <div class="trip-title">
              <%= @trip.title %>
            </div>
            <div class="button">
              <%= link_to "もどる", user_path(current_user.id), class:"btn btn-outline-primary" %>
            </div>
          </div>
          <div class="trip-content">
            <div class="trip-dates">
              <div>To : <%= @trip.start_date %></div>
              <div>End : <%= @trip.end_date %></div>
              <div>同伴者 :
                <% @trip.trip_users.each do |trip| %>
                  <% if trip.user_id != current_user.id %>
                    <%= User.where.not(id: current_user.id).where(id: trip.user_id).pluck(:nickname)[0] %> さん
                  <% end %>
                <% end %>
              </div>
            </div>
          </div>
          <div class="button">
            <%= link_to "編集", edit_trip_path(@trip.id), class:"btn btn-outline-success" %>
            <%= link_to '削除', trip_path(@trip.id), method: :delete, data: { confirm: '本当に削除してもよろしいですか?' }, class:"btn btn-outline-danger" %>
          </div>
        </div>
        <div class="item-img-content">
          <%= image_tag @trip.image.variant(resize: '300x200'),class:"item-box-img" %>
        </div>
      </div>

      <%# TODO 詳細スケジュールの一覧表示 %>
      <%#= render @details %>
      <%# 詳細スケジュールの一覧表示 %>

      <%# 詳細スケジュールの入力欄 %>
      <div>
        入力フォーム
        <%= form_with model: [@trip, @detail], class: 'trip-new-main', local: true do |f| %>
        <div class="new-trip-form-wrap">
          <div class="new-trip-form-header">
            <p>詳細スケジュールを作成</p>
          </div>

          <div class="error_messages">
            <%= render 'shared/error_messages', model: f.object %>
          </div>

          <div class="form-group">
            <div class='form-text-wrap'>
              <label class="form-text" for="trip-title">スケジュール名</label>
              <span class="form-text required">必須</span>
            </div>
            <%= f.text_area :title, class:"input-default", id:"trip-title", placeholder:"(例) 東京タワー" %>
            <label class="form-text" for="trip-title-note">備考</label>
            <%= f.text_area :note, class:"input-default", id:"trip-title-note", placeholder:"お土産購入" %>
          </div>

          <div class="form-group">
            <div class='form-text-wrap'>
              <label class="form-text" for="address">住所</label>
            </div>
            <%= f.text_area :address, class:"input-default", id:"address", placeholder:"(例) 東京都港区芝公園4-2-8" %>
          </div>

          <div class="form-group">
            <div class='form-text-wrap'>
              <label class="form-text" for="date">日付</label>
            </div>
            <%= f.date_field :time, class:"input-default", id:"date" %>
          </div>

          <div class="form-group">
            <div class='form-text-wrap'>
              <label class="form-text" for="time">時刻</label>
            </div>
            <%= f.time_field :time, class:"input-default", id:"time", placeholder:"(例) 12:00" %>
          </div>

          <div class="form-group">
            <div class='form-text-wrap'>
              <label class="form-text" for="time_note">時刻備考</label>
            </div>
            <%= f.text_field :time_note, class:"input-default", id:"time_note", placeholder:"(例) 過ぎ" %>
          </div>

          <div class="form-group">
            <div class='form-text-wrap'>
              <label class="form-text" for="url">URL</label>
            </div>
            <%= f.text_field :url, class:"input-default", id:"url" %>
          </div>

          <div class="form-group">
            <div class='form-text-wrap'>
              <label class="form-text" for="importance">重要度</label>
              <span class="form-text required">必須</span>
            </div>
            <%= f.select :importance, [[1, 1], [2, 2], [3, 3], [4, 4], [5, 5]], include_blank: "選択して下さい", class:"form-text", id:"importance" %>
          </div>

          <%# 下部ボタン %>
          <div class="register-btn">
            <%= f.submit "新規作成",class:"btn btn-outline-primary register-go-btn" %>
            <%= link_to 'もどる', "/", class:"btn btn-outline-secondary back-btn" %>
          </div>
          <%# /下部ボタン %>
        </div>

        <% end %>
      </div>
      <%# 詳細スケジュールの入力欄 %>

    </div>
  </div>
</main>

<%= render "shared/footer" %>
